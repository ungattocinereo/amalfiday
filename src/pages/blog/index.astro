---
import BaseLayout from '../../layouts/BaseLayout.astro'
import { blogCategories, blogTags } from '../../data/site'
import { getGhostPosts } from '../../data/ghost'

const posts = await getGhostPosts({ limit: 12 })
---

<BaseLayout title="Blog â€” Amalfi.Day">
  <section class="section">
    <div class="container">
      <h1>
        Amalfi <span class="accent-italic">notes</span>
      </h1>
      <p>News, local routes, and photography stories from the coast.</p>

      <div class="filters">
        {blogCategories.map((cat) => (
          <button class="chip">
            <i class="bi bi-tag"></i> {cat}
          </button>
        ))}
      </div>

      <div class="tag-row">
        <span>Tags:</span>
        {blogTags.map((tag) => (
          <span class="tag">
            <i class="bi bi-hash"></i>
            {tag}
          </span>
        ))}
      </div>

      <div class="grid">
        {posts.map((post) => (
          <article class="card">
            <div class="media">
              {post.image ? (
                <img src={post.image} alt={post.title} loading="lazy" decoding="async" />
              ) : (
                <div class="media__placeholder" aria-hidden="true"></div>
              )}
            </div>
            <div class="content">
              <div class="meta">
                <i class="bi bi-calendar3"></i> {post.date}
              </div>
              <h3>{post.title}</h3>
              <p>{post.excerpt}</p>
              <a href={post.href}>
                <i class="bi bi-arrow-up-right"></i> Read more
              </a>
            </div>
          </article>
        ))}
      </div>
    </div>
  </section>
</BaseLayout>

<style>
  h1 {
    font-size: clamp(2.4rem, 4vw, 3.8rem);
  }

  .filters {
    display: flex;
    flex-wrap: wrap;
    gap: 0.6rem;
    margin: 1.5rem 0 1rem;
  }

  .chip {
    border: 1px solid var(--color-surface);
    background: var(--color-card);
    padding: 0.5rem 1rem;
    border-radius: 999px;
    cursor: pointer;
    font-weight: 500;
    display: inline-flex;
    align-items: center;
    gap: 0.4rem;
  }

  .chip:hover {
    border-color: var(--color-accent);
    color: var(--color-accent);
  }

  .tag-row {
    display: flex;
    flex-wrap: wrap;
    gap: 0.6rem;
    align-items: center;
    margin-bottom: 2rem;
    color: var(--color-text-muted);
    font-size: 0.9rem;
  }

  .tag {
    background: var(--color-surface);
    padding: 0.3rem 0.7rem;
    border-radius: 999px;
    display: inline-flex;
    align-items: center;
    gap: 0.3rem;
  }

  .grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
    gap: 1.5rem;
  }

  .card {
    overflow: hidden;
  }

  .media {
    height: 170px;
    background: linear-gradient(140deg, rgba(255, 89, 0, 0.2), rgba(255, 195, 0, 0.2));
    position: relative;
  }

  .media img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  .media__placeholder {
    position: absolute;
    inset: 0;
    background: linear-gradient(140deg, rgba(255, 89, 0, 0.2), rgba(1, 98, 255, 0.2));
  }

  .content {
    padding: 1.4rem;
  }

  .meta {
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.08em;
    color: var(--color-text-muted);
    display: inline-flex;
    align-items: center;
    gap: 0.4rem;
  }
</style>
