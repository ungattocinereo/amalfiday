---
import BaseLayout from '../layouts/BaseLayout.astro'

const pageTitle = 'Contact — CristallPont Amalfi Day'
const pageDescription =
  'Contact Amalfi.Day for Booking.com & Airbnb stays, concierge services, and Amalfi Coast photoshoots.'
const shareImage = '/photoshootings/hero/couple/02-slideshow-regan-walk-ravello-love-1024x682.webp'
const heroImage = '/staticpages/contact/contact-us.webp'

const whatsappNumber = import.meta.env.PUBLIC_WHATSAPP_PHONE || ''
const whatsappDigits = whatsappNumber ? whatsappNumber.replace(/[^\d]/g, '') : ''
const whatsappHref = whatsappDigits ? `https://wa.me/${whatsappDigits}` : 'https://wa.me/'
---

<BaseLayout title={pageTitle} description={pageDescription} image={shareImage}>
  <section class="contact-hero hero--dark">
    <div class="contact-hero__media">
      <img
        class="contact-hero__image"
        src={heroImage}
        alt="Amalfi coast cliffside and sea"
        loading="eager"
        fetchpriority="high"
      />
    </div>
    <div class="contact-hero__veil" aria-hidden="true"></div>
    <div class="contact-hero__glow" aria-hidden="true"></div>
    <div class="container contact-hero__content">
      <div class="contact-hero__copy">
        <span class="badge contact-hero__badge">
          <i class="bi bi-chat-heart"></i> Contact Amalfi.Day
        </span>
        <h1>
          Contact us <span class="accent-italic">right now</span>
        </h1>
        <p class="contact-hero__lead">
          Tell us your dates, mood, and priorities. We will craft a custom plan for your Amalfi
          Coast stay, photoshoot, or concierge request and reply within 24 hours.
        </p>
        <div class="contact-hero__actions">
          <a class="button" href="#contact-form">
            <i class="bi bi-send"></i> Send a request
          </a>
          <a class="button button--ghost" href={whatsappHref} target="_blank" rel="noreferrer">
            <i class="bi bi-whatsapp"></i> WhatsApp
          </a>
        </div>
        <p class="contact-hero__note">
          Prefer WhatsApp? <a href={whatsappHref} target="_blank" rel="noreferrer">Start a chat</a>.
        </p>
      </div>
    </div>
  </section>

  <section class="section contact-book">
    <div class="container contact-book__inner">
      <div class="contact-eyebrow">WHERE WE BOOK</div>
      <h1>
        Amalfi Coast stays on <span class="accent-italic">Booking.com</span> &
        <span class="accent-italic">Airbnb</span>
      </h1>
      <p>
        Most accommodation reservations are arranged through
        <a href="https://www.booking.com/" target="_blank" rel="noreferrer">Booking.com</a>
        and
        <a href="https://www.airbnb.com/" target="_blank" rel="noreferrer">Airbnb</a>.
        Our apartments are listed on these platforms, so you can book them quickly and securely.
        We send direct links to trusted listings and help compare options in Amalfi, Positano,
        Ravello, and Atrani so you can book with confidence.
      </p>
      <p>
        Beyond stays, we handle every detail: taxi and private transfers, porter support for
        luggage, as well as masterclasses, local tastings, and curated experiences. Tell us what
        you need and we will coordinate the rest.
      </p>
    </div>
  </section>

  <section class="section contact-help">
    <div class="container">
      <h1>How we can help</h1>
      <div class="contact-help__grid">
        <article class="contact-help__card">
          <div class="contact-help__icon"><i class="bi bi-car-front"></i></div>
          <h3>Transfers & taxis</h3>
          <p>Private drivers, airport pickups, and day-trip routing built around your schedule.</p>
        </article>
        <article class="contact-help__card">
          <div class="contact-help__icon"><i class="bi bi-luggage"></i></div>
          <h3>Porters & luggage help</h3>
          <p>Porter service for steep streets, ferry arrivals, and hotel transitions.</p>
        </article>
        <article class="contact-help__card">
          <div class="contact-help__icon"><i class="bi bi-brush"></i></div>
          <h3>Workshops & masterclasses</h3>
          <p>Cooking classes, ceramic workshops, and tasting experiences with local artisans.</p>
        </article>
        <article class="contact-help__card">
          <div class="contact-help__icon"><i class="bi bi-camera"></i></div>
          <h3>Photo planning</h3>
          <p>Golden-hour timing, location permits, and a calm, guided shoot experience.</p>
        </article>
      </div>
    </div>
  </section>

  <section class="section contact-plan" id="contact-form">
    <div class="container contact-plan__grid">
      <div class="contact-plan__intro">
        <div class="contact-eyebrow">PLAN WITH US</div>
        <h1>
          Let’s design your <span class="accent-italic">Amalfi</span> story
        </h1>
        <p>
          Share your dates, mood, and wishlist. We will build a tailored plan with the best light,
          locations, and timing for an effortless Amalfi Coast experience.
        </p>
        <div class="contact__links">
          <a class="contact-link" href={whatsappHref} target="_blank" rel="noreferrer">
            <span class="contact-link__icon"><i class="bi bi-whatsapp"></i></span>
            <span class="contact-link__text">
              <strong>WhatsApp</strong>
              <span>Send a message on WhatsApp</span>
            </span>
          </a>
          <a class="contact-link" href="mailto:hello@amalfi.day">
            <span class="contact-link__icon"><i class="bi bi-envelope"></i></span>
            <span class="contact-link__text">
              <strong>Email</strong>
              <span>Write us an email</span>
            </span>
          </a>
        </div>
      </div>

      <form class="contact-form" action="/api/contact" method="post">
        <div class="contact-form__header">
          <span class="badge"><i class="bi bi-stars"></i> Telegram-ready request</span>
          <h2>
            Send your <span class="accent-italic">plan</span> in minutes
          </h2>
          <p>
            Fill in the details below. Your request goes straight to Telegram so we can reply
            quickly with availability, pricing, and suggestions.
          </p>
        </div>
        <div class="contact-form__grid">
          <label>
            Your name
            <input type="text" name="name" placeholder="Iana" autocomplete="name" />
          </label>
          <label>
            Email or WhatsApp
            <input
              type="text"
              name="contact"
              placeholder="email or +39"
              autocomplete="email"
              required
            />
          </label>
          <label>
            Dates & location
            <input type="text" name="dates" placeholder="Oct 3–7, Atrani" required />
          </label>
          <label>
            Service
            <select name="service" required>
              <option value="" disabled selected>Select a service</option>
              <option value="Porters/taxi">Porters/taxi</option>
              <option value="Photoshooting">Photoshooting</option>
              <option value="Apartment">Apartment</option>
              <option value="Other">Other</option>
            </select>
          </label>
        </div>
        <label>
          Your message
          <textarea name="message" rows="5" placeholder="Tell us about your plans"></textarea>
        </label>
        <button class="button" type="submit">
          <i class="bi bi-send"></i> Send request
        </button>
        <p class="form__status" aria-live="polite">
          We will send your request directly to Telegram.
        </p>
      </form>
    </div>
  </section>

  <script>
    const form = document.querySelector('.contact-form')
    const status = document.querySelector('.form__status')
    const submitButton = form?.querySelector('button[type="submit"]')

    const setStatus = (text, state) => {
      if (!status) return
      status.textContent = text
      status.dataset.state = state || ''
    }

    form?.addEventListener('submit', async (event) => {
      event.preventDefault()
      setStatus('Sending your request...')
      if (submitButton) submitButton.disabled = true

      const formData = new FormData(form)
      const payload = Object.fromEntries(formData.entries())

      try {
        const response = await fetch('/api/contact', {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(payload),
        })

        if (!response.ok) {
          throw new Error('Request failed')
        }

        form.reset()
        setStatus('Thank you! We will get back to you shortly.', 'success')
      } catch (error) {
        setStatus('Sorry, something went wrong. Please email hello@amalfi.day.', 'error')
      } finally {
        if (submitButton) submitButton.disabled = false
      }
    })
  </script>
</BaseLayout>

<style>
  .contact-hero {
    position: relative;
    min-height: 100svh;
    display: grid;
    align-items: stretch;
    color: #ffffff;
    overflow: hidden;
    background: #0f1115;
  }

  .contact-hero__media {
    position: absolute;
    inset: 0;
    z-index: 0;
  }

  .contact-hero__image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    object-position: center top;
    filter: saturate(1.05) contrast(1.02);
  }

  .contact-hero__veil {
    position: absolute;
    inset: 0;
    z-index: 1;
    background: linear-gradient(
      180deg,
      rgba(10, 12, 15, 0.35) 0%,
      rgba(10, 12, 15, 0.72) 55%,
      rgba(10, 12, 15, 0.92) 100%
    );
  }

  .contact-hero__glow {
    position: absolute;
    inset: 0;
    z-index: 1;
    background: radial-gradient(circle at 20% 20%, rgba(255, 195, 0, 0.35), transparent 45%),
      radial-gradient(circle at 80% 10%, rgba(0, 156, 255, 0.28), transparent 45%);
    mix-blend-mode: screen;
    opacity: 0.7;
  }

  .contact-hero__content {
    position: relative;
    z-index: 2;
    min-height: 100svh;
    padding: calc(var(--header-space) + 1.5rem) 0 4rem;
    display: grid;
    align-items: center;
    justify-items: start;
  }

  .contact-hero__badge {
    background: rgba(15, 17, 21, 0.65);
    color: #ffffff;
    border: 1px solid rgba(255, 255, 255, 0.15);
  }

  .contact-hero__copy {
    max-width: 640px;
    justify-self: start;
    text-align: left;
  }

  .contact-hero__copy h1 {
    font-size: clamp(3rem, 7vw, 4.8rem);
    margin-bottom: 1rem;
  }

  .contact-hero__lead {
    font-size: 1.1rem;
    color: rgba(255, 255, 255, 0.85);
  }

  .contact-hero__actions {
    display: flex;
    flex-wrap: wrap;
    gap: 1rem;
    margin-top: 1.6rem;
  }

  .contact-hero__note {
    margin-top: 1.2rem;
    color: rgba(255, 255, 255, 0.7);
  }

  .contact-hero__note a {
    color: #ffffff;
    font-weight: 600;
  }

  .button--ghost {
    background: rgba(15, 17, 21, 0.45);
    border: 1px solid rgba(255, 255, 255, 0.2);
    color: #ffffff;
  }

  .contact-book__inner {
    max-width: 860px;
    display: grid;
    gap: 1.2rem;
  }

  .contact-book__inner .contact-eyebrow {
    margin-bottom: 0.4rem;
  }

  .contact-eyebrow {
    font-family: var(--font-mono);
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.2em;
    color: var(--color-text-muted);
    margin-bottom: 1rem;
  }

  .contact-help h1 {
    margin-bottom: 2rem;
  }

  .contact-help__grid {
    display: grid;
    grid-template-columns: repeat(4, minmax(0, 1fr));
    gap: 1.4rem;
  }

  .contact-help__card {
    padding: 1.6rem;
    border-radius: var(--radius-lg);
    background: linear-gradient(135deg, rgba(255, 195, 0, 0.08), transparent 55%),
      var(--color-card);
    border: 1px solid var(--color-border);
    box-shadow: var(--shadow-soft);
    display: grid;
    gap: 0.8rem;
  }

  .contact-help__icon {
    width: 44px;
    height: 44px;
    border-radius: 14px;
    background: rgba(1, 98, 255, 0.12);
    display: grid;
    place-items: center;
    font-size: 1.3rem;
    color: var(--color-aux);
  }

  .contact-help__card h3 {
    margin: 0;
  }

  .contact-plan__grid {
    display: grid;
    grid-template-columns: minmax(0, 0.9fr) minmax(0, 1.1fr);
    gap: 3rem;
    align-items: start;
  }

  .contact__links {
    display: grid;
    gap: 1.2rem;
    margin-top: 1.5rem;
  }

  .contact-link {
    display: grid;
    grid-template-columns: auto 1fr;
    align-items: center;
    gap: 1rem;
    color: var(--color-text);
    text-decoration: none;
  }

  .contact-link__icon {
    width: 56px;
    height: 56px;
    border-radius: 50%;
    display: grid;
    place-items: center;
    font-size: 1.5rem;
    background: rgba(1, 98, 255, 0.12);
    color: var(--color-aux);
  }

  .contact-link__text {
    display: grid;
    gap: 0.2rem;
  }

  .contact-link__text strong {
    font-size: 1rem;
  }

  .contact-link__text span {
    color: var(--color-text-muted);
    font-size: 0.95rem;
  }

  .contact-form {
    width: 100%;
    display: flex;
    flex-direction: column;
    gap: 1.2rem;
    padding: 3rem;
    border-radius: 32px;
    background: linear-gradient(140deg, rgba(255, 255, 255, 0.96), rgba(255, 255, 255, 0.9));
    box-shadow: 0 30px 60px rgba(10, 12, 15, 0.12);
    position: relative;
    text-align: left;
    overflow: hidden;
  }

  .contact-form__header {
    display: grid;
    gap: 0.6rem;
    justify-items: start;
  }

  .contact-form::before {
    content: '';
    position: absolute;
    inset: -1px;
    border-radius: 34px;
    padding: 1px;
    background: linear-gradient(135deg, rgba(255, 89, 0, 0.45), rgba(0, 156, 255, 0.35));
    -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
    -webkit-mask-composite: xor;
    mask-composite: exclude;
    pointer-events: none;
  }

  .contact-form::after {
    content: '';
    position: absolute;
    right: -20%;
    top: -25%;
    width: 260px;
    height: 260px;
    background: radial-gradient(circle, rgba(255, 195, 0, 0.22), transparent 70%);
    opacity: 0.8;
    pointer-events: none;
  }

  .contact-form__grid {
    display: grid;
    grid-template-columns: repeat(2, minmax(0, 1fr));
    gap: 1rem 1.2rem;
  }

  label {
    display: flex;
    flex-direction: column;
    gap: 0.5rem;
    font-weight: 600;
    color: var(--color-text);
  }

  input,
  textarea,
  select {
    border: 1px solid rgba(26, 26, 26, 0.12);
    border-radius: 14px;
    padding: 0.85rem 1rem;
    font-family: var(--font-body);
    background: rgba(255, 255, 255, 0.9);
    color: var(--color-text);
    transition: border 0.2s ease, box-shadow 0.2s ease;
  }

  input:focus,
  textarea:focus,
  select:focus {
    outline: none;
    border-color: rgba(1, 98, 255, 0.5);
    box-shadow: 0 0 0 3px rgba(1, 98, 255, 0.15);
  }

  select {
    appearance: none;
    background-image: linear-gradient(45deg, transparent 50%, rgba(26, 26, 26, 0.6) 50%),
      linear-gradient(135deg, rgba(26, 26, 26, 0.6) 50%, transparent 50%),
      linear-gradient(to right, rgba(26, 26, 26, 0.08), rgba(26, 26, 26, 0.08));
    background-position: calc(100% - 1.2rem) calc(50% + 2px), calc(100% - 0.95rem) calc(50% + 2px),
      calc(100% - 2.4rem) 50%;
    background-size: 8px 8px, 8px 8px, 1px 1.8rem;
    background-repeat: no-repeat;
    padding-right: 2.8rem;
  }

  .contact-form button {
    display: inline-flex;
    align-items: center;
    gap: 0.5rem;
    width: fit-content;
  }

  .contact-form button:disabled {
    opacity: 0.7;
    cursor: progress;
  }

  .form__status {
    margin: 0.2rem 0 0;
    color: var(--color-text-muted);
  }

  .form__status[data-state='success'] {
    color: #1f8a3b;
  }

  .form__status[data-state='error'] {
    color: #c0352b;
  }

  @media (max-width: 980px) {
    .contact-hero__content {
      padding: calc(var(--header-space) + 2rem) 0 3rem;
    }

    .contact-help__grid {
      grid-template-columns: repeat(2, minmax(0, 1fr));
    }

    .contact-plan__grid {
      grid-template-columns: 1fr;
    }

    .contact-form__grid {
      grid-template-columns: 1fr;
    }
  }

  @media (max-width: 640px) {
    .contact-form {
      padding: 2.2rem 1.5rem;
    }

    .contact-help__grid {
      grid-template-columns: 1fr;
    }
  }
</style>
