---
import BaseLayout from '../layouts/BaseLayout.astro'

const heroCategories = [
  {
    key: 'influencer',
    title: 'INFLUENCER PHOTOSHOOT',
    subtitle: 'Stand out from the crowd and captivate your followers with high-quality images',
  },
  {
    key: 'couple',
    title: 'COUPLE PICTURE TAKING',
    subtitle: 'Cherish your memories of Amalfi and your love forever with our tailored photo sessions',
  },
  {
    key: 'personal',
    title: 'PERSONAL PHOTO SHOOTING',
    subtitle:
      'The most picturesque locations and capture your personality in stunning, high-quality images',
  },
]

const heroImages = {
  influencer: [
    '/photoshootings/hero/influencer/3-berra-influenser-slider-slider.jpg',
    '/photoshootings/hero/influencer/bissa-ninfulenser-icecream.jpg',
    '/photoshootings/hero/influencer/tag-preview-photoshooting-in-ravello-2024-1024x766.webp',
  ],
  couple: [
    '/photoshootings/hero/couple/02-slideshow-regan-walk-ravello-love-1024x682.webp',
    '/photoshootings/hero/couple/couple-photoshooting-amalfi.jpg',
    '/photoshootings/hero/couple/katerina-kuznezova-praiano-2021-002.jpg',
  ],
  personal: [
    '/photoshootings/hero/personal/Masha-Minchuck-Amalfi-day.jpg',
    '/photoshootings/hero/personal/Silvia-Amalfi-day.jpg.jpg',
    '/photoshootings/hero/personal/iiana-photo-hero-atrani-hat-2-1024x680.webp',
  ],
}

const firstHeroImage = heroImages[heroCategories[0].key][0]
const individualAlbum = [
  '/photoshootings/individual/Masha-Minchuck-Amalfi-day.jpg',
  '/photoshootings/individual/Silvia-Amalfi-day.jpg.jpg',
  '/photoshootings/individual/bissa-ninfulenser-icecream.jpg',
  '/photoshootings/individual/tag-preview-photoshooting-in-ravello-2024-1024x766.webp',
  '/photoshootings/individual/iiana-photo-hero-atrani-hat-2-1024x680.webp',
  '/photoshootings/individual/berrasguy-Minchuck-Amalfi-day.jpg.jpg',
]

const coupleAlbum = [
  '/photoshootings/couples/02-slideshow-regan-walk-ravello-love-1024x682.webp',
  '/photoshootings/couples/couple-photoshooting-amalfi.jpg',
  '/photoshootings/couples/DSC0789.jpg',
  '/photoshootings/couples/DSC8503.jpg',
  '/photoshootings/couples/img_5f68ca5842ca6.jpg',
  '/photoshootings/couples/katerina-kuznezova-praiano-2021-002.jpg',
]

const testimonials = [
  {
    quote:
      'I just wanted to say thank you again for making our families trip memorable. We have just spent a week with Taylor and Regan and the photos are incredible. They could not stop talking about your patience and how flexible you were. We maybe having an Amalfi wedding and you are top of our list. Thank you again',
    author: 'Estrallita Bloss',
    meta: 'Ravello, 2023',
  },
  {
    quote:
      "Greg's an excellent photographer. The angles, the lighting, the focus of the camera... all were amazing. He took such gorgeous photos of me on the Amalfi Coast that I'm obsessed with, and can't stop looking at. Definitely recommend to anyone looking for professionally done photos!",
    author: 'Bisaan Hanouneh',
    meta: 'Amalfi Coast, 2020',
  },
  {
    quote:
      'I express my deep gratitude to Gregory, for the fact that in addition to an exciting photo shoot, he gave us a fascinating tour and showed us those places that we could hardly find on our own. All love, kindness and amalfi mood☀️☀️☀️',
    author: 'Alex Dolgov',
    meta: 'Guest, 2020',
  },
  {
    quote:
      'Wonderful and rememberable journey, although it was only one night stay in the lovely and comfortable room with taste, taken care by the very kind and reliable host. The travel recommendations and even extra assist offered by Greg was really surprise.',
    author: '吴昊游',
    meta: 'Guest, 2019',
  },
]
---

<BaseLayout title="Photoshootings — Amalfi.Day">
  <section
    class="ps-hero hero--dark"
    data-sequence={JSON.stringify(
      heroCategories.map((cat) => ({
        title: cat.title,
        subtitle: cat.subtitle,
        images: heroImages[cat.key],
      }))
    )}
  >
    <div class="ps-hero__bg">
      <div
        class="ps-hero__layer is-active"
        style={`background-image:url('${firstHeroImage}')`}
      ></div>
      <div class="ps-hero__layer"></div>
    </div>
    <div class="ps-hero__content">
      <div class="ps-hero__text">
        <h1 id="ps-title">{heroCategories[0].title}</h1>
        <p id="ps-subtitle">{heroCategories[0].subtitle}</p>
        <div class="ps-hero__dots" aria-hidden="true"></div>
        <a class="button" href="/contact">Book now!</a>
      </div>
    </div>
  </section>

  <script is:inline>
    ;(() => {
      const heroEl = document.querySelector('.ps-hero')
      if (!heroEl) return
      const sequence = JSON.parse(heroEl.dataset.sequence || '[]')
      const layers = Array.from(document.querySelectorAll('.ps-hero__layer'))
      const titleEl = document.getElementById('ps-title')
      const subtitleEl = document.getElementById('ps-subtitle')
      const dotsWrap = document.querySelector('.ps-hero__dots')

      let catIndex = 0
      let imgIndex = -1
      let activeLayer = 0

      const IMAGE_DURATION = 3000
      const zoomClass = 'is-zoom'

      const preload = (src) => {
        const img = new Image()
        img.src = src
      }

      const setupDots = (count) => {
        if (!dotsWrap) return
        dotsWrap.innerHTML = ''
        for (let i = 0; i < count; i += 1) {
          const dot = document.createElement('span')
          dot.className = 'ps-hero__dot'
          dotsWrap.appendChild(dot)
        }
      }

      const updateDots = (index) => {
        if (!dotsWrap) return
        const dots = dotsWrap.querySelectorAll('.ps-hero__dot')
        dots.forEach((dot, i) => {
          dot.classList.toggle('is-active', i === index)
        })
      }

      const setText = (cat) => {
        titleEl.classList.add('is-fading')
        subtitleEl.classList.add('is-fading')
        window.setTimeout(() => {
          titleEl.textContent = cat.title
          subtitleEl.textContent = cat.subtitle
          titleEl.classList.remove('is-fading')
          subtitleEl.classList.remove('is-fading')
        }, 300)
      }

      const showImage = (src) => {
        const nextLayer = layers[1 - activeLayer]
        const currentLayer = layers[activeLayer]

        nextLayer.style.backgroundImage = `url(\"${src}\")`
        nextLayer.classList.add('is-active')
        nextLayer.classList.remove(zoomClass)
        void nextLayer.offsetWidth
        nextLayer.classList.add(zoomClass)

        currentLayer.classList.remove('is-active')

        activeLayer = 1 - activeLayer
      }

      const step = () => {
        if (!sequence.length) return
        const cat = sequence[catIndex]
        imgIndex = (imgIndex + 1) % cat.images.length

        if (imgIndex === 0) {
          setText(cat)
          setupDots(cat.images.length)
        }

        showImage(cat.images[imgIndex])
        updateDots(imgIndex)

        const nextImg = cat.images[(imgIndex + 1) % cat.images.length]
        preload(nextImg)

        if (imgIndex === cat.images.length - 1) {
          catIndex = (catIndex + 1) % sequence.length
        }
      }

      sequence.forEach((cat) => cat.images.forEach(preload))
      setupDots(sequence[0]?.images?.length || 0)
      step()
      window.setInterval(step, IMAGE_DURATION)
    })()
  </script>

  <section class="section">
    <div class="container">
      <div class="section__header">
        <h2>Individual photo sessions</h2>
        <p>Capture your personality in stunning, high-quality images.</p>
      </div>
      <div class="album">
        {individualAlbum.map((src) => (
          <div class="album__item">
            <img src={src} alt="Individual photoshoot" loading="lazy" />
          </div>
        ))}
      </div>
    </div>
  </section>

  <section class="section testimonials">
    <div class="container">
      <div class="section__header">
        <h2>Testimonials</h2>
        <p>Real words from guests who trusted Amalfi.Day.</p>
      </div>
      <div class="testimonials__grid">
        {testimonials.map((item) => (
          <article class="card testimonial">
            <p>“{item.quote}”</p>
            <strong>{item.author}</strong>
            <span>{item.meta}</span>
          </article>
        ))}
      </div>
    </div>
  </section>

  <section class="section">
    <div class="container">
      <div class="section__header">
        <h2>Couple photo sessions</h2>
        <p>Preserve your love story against Amalfi's most romantic backdrops.</p>
      </div>
      <div class="album">
        {coupleAlbum.map((src) => (
          <div class="album__item">
            <img src={src} alt="Couple photoshoot" loading="lazy" />
          </div>
        ))}
      </div>
    </div>
  </section>
</BaseLayout>

<style>
  .ps-hero {
    min-height: 100vh;
    padding-top: var(--header-space);
    margin-top: calc(-1 * var(--header-space));
    position: relative;
    color: #ffffff;
    display: flex;
    align-items: center;
    overflow: hidden;
    box-sizing: border-box;
  }

  .ps-hero__bg {
    position: absolute;
    inset: 0;
    background: #0f1115;
  }

  .ps-hero__layer {
    position: absolute;
    inset: 0;
    background-size: cover;
    background-position: center;
    opacity: 0;
    transition: opacity 500ms ease;
    filter: brightness(0.65);
    will-change: transform, opacity;
  }

  .ps-hero__layer.is-active {
    opacity: 1;
  }

  .ps-hero__layer.is-zoom {
    animation: ps-zoom 2s ease-out forwards;
  }

  .ps-hero__content {
    position: relative;
    z-index: 2;
    width: 100%;
    max-width: var(--container-max);
    margin: 0 auto;
    padding: 0 1.5rem;
  }

  .ps-hero__text {
    max-width: 720px;
    text-align: left;
  }

  .ps-hero__text h1 {
    font-size: clamp(2.6rem, 5vw, 4.2rem);
    transition: opacity 0.3s ease, transform 0.3s ease;
  }

  .ps-hero__text p {
    color: rgba(255, 255, 255, 0.8);
    font-size: 1.1rem;
    transition: opacity 0.3s ease, transform 0.3s ease;
  }

  .ps-hero__text h1.is-fading,
  .ps-hero__text p.is-fading {
    opacity: 0.4;
    transform: translateY(6px);
    transition: opacity 0.3s ease, transform 0.3s ease;
  }

  .ps-hero__dots {
    display: flex;
    gap: 0.5rem;
    margin: 1.2rem 0 0.4rem;
  }

  .ps-hero__dot {
    width: 8px;
    height: 8px;
    border-radius: 999px;
    background: rgba(255, 255, 255, 0.35);
    transition: transform 0.3s ease, background 0.3s ease;
  }

  .ps-hero__dot.is-active {
    background: #ffffff;
    transform: scale(1.3);
  }

  .ps-hero__text .button {
    margin-top: 1.5rem;
  }

  @keyframes ps-zoom {
    from {
      transform: scale(1.005) translate3d(0, 0, 0);
    }
    to {
      transform: scale(1.05) translate3d(-0.5%, -0.5%, 0);
    }
  }

  @media (prefers-reduced-motion: reduce) {
    .ps-hero__layer {
      transition: none;
      animation: none !important;
    }
  }

  .album {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
    gap: 1rem;
  }

  .album__item {
    border-radius: 16px;
    overflow: hidden;
    box-shadow: var(--shadow-soft);
  }

  .album__item img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    display: block;
  }

  .testimonials {
    background: var(--color-surface);
  }

  .testimonials__grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
    gap: 1.5rem;
  }

  .testimonial {
    padding: 1.5rem;
  }

  .testimonial strong {
    display: block;
    margin-top: 1rem;
    color: var(--color-text);
  }

  .testimonial span {
    color: var(--color-text-muted);
    font-size: 0.85rem;
  }

  @media (max-width: 720px) {
    .ps-hero__text {
      max-width: 100%;
    }
  }
</style>
